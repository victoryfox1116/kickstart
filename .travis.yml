dist: trusty
language: rust
services: docker
env:
  global:
  - CRATE_NAME=kickstart
  - secure: qPDFXwphU9qJ3zZbWhbk1AbBPCFkbl8ZphceJ8JAJQmHbwC6nF4NBpdEKyY3O+0C4zmOa24tFZYC2exN9SyEtrsqRwR/KWRqSkEt1lZ0c7k/Vq7PihR2/q9maH8qfJ1kLNvE5D3bM1m2hvrqMPv2pVZlK4iZFCsEulO4Bv9v1yDt8CEU8ijRqBk5/HlKQKTA5wJKQmyr6t5/hr4WGnTx8B27Cf28WXqia0MNTcTOEtcr6URuuNMN6Nh+Ifz80+inSWGEzQ/HXR7W1MDllAhtd5hormWlgPSllAUfkHqQ3AjFdw01ahgHivqUdPiB9WAIOu1qRusfX91OBn1tcCtYPp9CQI6okKq8T/BAOKuKHWrbAbNPZlqRp6fEDisStAZK+55I6lanN0OYDvKdY07/txhF2BnvqvIzbxzpiJmTMcNzd6rUeY2O6qxATXr2eI900o8uGNxFcL0qri/gt6Vj+Hp2fbOObXD2B9yhP1ZSTEsctuMMU0NfdYz8p/JL25ZihC/6jECx/HLvh+Z2IprSvUJk/DL39dEQHrI9Ghu5EBuYLIjCf/jOl8610ha7B6pWoc3TRRu/D1KDEOABkj06kNeCqfb4DMKYyIprFzL72r4aWsApgYAvHZQrDgGR7kFetHknU7QIWyRQCsbwPk19tL85SN8VhgFP4WZ0H05CVHY=
matrix:
  include:
  - env: TARGET=x86_64-unknown-linux-gnu
  - env: TARGET=x86_64-apple-darwin
    os: osx
before_install: set -e
install:
- sh ci/install.sh
- source ~/.cargo/env || true
script:
- bash ci/script.sh
after_script: set +e
before_deploy:
- sh ci/before_deploy.sh
deploy:
  api_key:
    secure: "j1q8qWi9KgFOgalsJOeHKq0fKuDTzc9uldWe3Ld12gDXnqrUwJa1vtShogjZSY2qY9K+cbxQPuavU+hZPVPtC5dyw8ozT+uHsaHQ6Lhg/WMKgYXZaAIPWoBvFCw24VjizT2RBUd6fQ6VAC7n6/CEZ5ZT+70KHCc0x8HarEYpa2Rd73fG4ZMaAORHCowv0P5aqqOaUOJycBKuKZTRYNXpvHQk0DJdhqh6ZdSNA7KBOQSdNsf2//iwerH1E7rccRSEI6xvaT6LUyN+0k27b2e9hwTQ0tMJ2+JhKTUVdqoFReSrWd/umFp7pHGEEueJe9ATVhd+71mfQbQNZbh33FLRDZORJCliL0PyHZSKHYH8BZVPt1Na6ACUItBS5rO3olLnt0kVbcKDgdP2L1vrZ2Tydsu42w6XpclBAKSIQJgydYDxGEbFn1tGdEIITk/TerpWawJ5vhz1JNolC4bWPkGRGaNxF3hIgm8auyWesqYFGFyjMn9CcWObFLcO32lNfyMx60EP7QoIzGWlifyNAp0GnN1gCU+GBeVJKnwpFCtmiS5bBqcawrlRm6+wyN8SDE8Ndy3a8jO0bwFAiCVy6bW5Bkx3HIFkRTc5UfINptN7STPatqhiIMTrgPWDIKRngw38HzcilBO2+FQKle44wq1MmMizb0IODDzQ0f8FrhQYEoI="
  file_glob: true
  file: "$CRATE_NAME-$TRAVIS_TAG-$TARGET.*"
  on:
    condition: "$TRAVIS_RUST_VERSION = stable"
    tags: true
  provider: releases
  skip_cleanup: true
cache: cargo
before_cache:
- chmod -R a+r $HOME/.cargo
branches:
  only:
  - "/^v\\d+\\.\\d+\\.\\d+.*$/"
  - master
notifications:
  email: false
